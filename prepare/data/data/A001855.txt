{
    "number": 1855,
    "id": "M2433 N0963",
    "data": "0,1,3,5,8,11,14,17,21,25,29,33,37,41,45,49,54,59,64,69,74,79,84,89,94,99,104,109,114,119,124,129,135,141,147,153,159,165,171,177,183,189,195,201,207,213,219,225,231,237,243,249,255,261,267,273,279,285",
    "name": "Sorting numbers: maximal number of comparisons for sorting n elements by binary insertion.",
    "comment": [
        "Equals n-1 times the expected number of probes for a successful binary search in a size n-1 list.",
        "Piecewise linear: breakpoints at powers of 2 with values given by A000337.",
        "a(n) is the number of digits in the binary representation of all the numbers 1 to n-1. - _Hieronymus Fischer_, Dec 05 2006",
        "It is also coincidentally the maximum number of comparisons for merge sort. - _Li-yao Xia_, Nov 18 2015"
    ],
    "reference": [
        "D. E. Knuth, The Art of Computer Programming. Addison-Wesley, Reading, MA, Vol. 3, Sect 5.3.1, Eq. (3); Sect. 6.2.1 (4).",
        "J. W. Moon, Topics on Tournaments. Holt, NY, 1968, p. 48.",
        "N. J. A. Sloane, A Handbook of Integer Sequences, Academic Press, 1973 (includes this sequence).",
        "N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence).",
        "Tianxing Tao, On optimal arrangement of 12 points, pp. 229-234 in Combinatorics, Computing and Complexity, ed. D. Du and G. Hu, Kluwer, 1989."
    ],
    "link": [
        "T. D. Noe, <a href=\"/A001855/b001855.txt\">Table of n, a(n) for n = 1..1000</a>",
        "Michael Albert, Michael Engen, Jay Pantone, Vincent Vatter, <a href=\"https://arxiv.org/abs/1710.04240\">Universal layered permutations</a>, arXiv:1710.04240 [math.CO], (2017)",
        "J.-P. Allouche and J. Shallit, <a href=\"https://doi.org/10.1016/0304-3975(92)90001-V\">The ring of k-regular sequences</a>, Theoretical Computer Sci., 98 (1992), 163-197.",
        "Sung-Hyuk Cha, <a href=\"http://www.wseas.us/e-library/conferences/2012/CambridgeUSA/MATHCC/MATHCC-60.pdf\">On Integer Sequences Derived from Balanced k-ary Trees</a>, Applied Mathematics in Electrical and Computer Engineering, 2012.",
        "Sung-Hyuk Cha, <a href=\"http://naun.org/multimedia/UPress/ami/16-125.pdf\">On Complete and Size Balanced k-ary Tree Integer Sequences</a>, International Journal of Applied Mathematics and Informatics, Issue 2, Volume 6, 2012, pp. 67-75. - From _N. J. A. Sloane_, Dec 24 2012",
        "Hsien-Kuei Hwang, S. Janson, T. H. Tsai, <a href=\"http://140.109.74.92/hk/wp-content/files/2016/12/aat-hhrr-1.pdf\">Exact and asymptotic solutions of the recurrence f(n) = f(floor(n/2)) + f(ceiling(n/2)) + g(n): theory and applications</a>, Preprint 2016.",
        "Hsien-Kuei Hwang, S. Janson, T. H. Tsai, <a href=\"https://doi.org/10.1145/3127585\">Exact and Asymptotic Solutions of a Divide-and-Conquer Recurrence Dividing at Half: Theory and Applications</a>, ACM Transactions on Algorithms, 13:4 (2017), #47; DOI: 10.1145/3127585.",
        "Tanya Khovanova, <a href=\"http://arxiv.org/abs/1410.2193\">There are no coincidences</a>, arXiv preprint 1410.2193 [math.CO], 2014.",
        "D. Knuth, <a href=\"/A003063/a003063.pdf\">Letter to N. J. A. Sloane, date unknown</a>",
        "R. Stephan, <a href=\"/somedcgf.html\">Some divide-and-conquer sequences ...</a>",
        "R. Stephan, <a href=\"/A079944/a079944.ps\">Table of generating functions</a>",
        "Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/Sorting.html\">Sorting.</a>",
        "<a href=\"/index/So#sorting\">Index entries for sequences related to sorting</a>"
    ],
    "formula": [
        "Let n = 2^(k-1) + g, 0 <= g <= 2^(k-1); then a(n) = 1 + n*k - 2^k. - _N. J. A. Sloane_, Dec 01 2007",
        "a(n) = Sum_{k=1..n}ceiling(log_2 k) = n*ceiling(log_2 n) - 2^ceiling(log_2(n)) + 1.",
        "a(n) = a(floor(n/2)) + a(ceiling(n/2)) + n - 1.",
        "G.f.: x/(1-x)^2 * Sum_{k>=0} x^2^k. - _Ralf Stephan_, Apr 13 2002",
        "a(1)=0, for n>1, a(n) = ceiling(n*a(n-1)/(n-1)+1). - _Benoit Cloitre_, Apr 26 2003",
        "a(n) = n-1 + min { a(k)+a(n-k) : 1 <= k <= n-1 }, cf. A003314. - _Vladeta Jovovic_, Aug 15 2004",
        "a(n) = A061168(n-1) + n - 1 for n>1. - _Hieronymus Fischer_, Dec 05 2006",
        "a(n) = A123753(n-1) - n. - _Peter Luschny_, Nov 30 2017"
    ],
    "maple": [
        "a := proc(n) local k; k := ilog2(n) + 1; 1 + n*k - 2^k end; # _N. J. A. Sloane_, Dec 01 2007 [edited by _Peter Luschny_, Nov 30 2017]"
    ],
    "mathematica": [
        "a[n_?EvenQ] := a[n] = n + 2a[n/2] - 1; a[n_?OddQ] := a[n] = n + a[(n+1)/2] + a[(n-1)/2] - 1; a[1] = 0; a[2] = 1; Table[a[n], {n, 1, 58}] (* _Jean-Fran\u00e7ois Alcover_, Nov 23 2011, after Pari *)",
        "a[n_] := n IntegerLength[n, 2] - 2^IntegerLength[n, 2] + 1;",
        "Table[a[n], {n, 1, 58}] (* _Peter Luschny_, Dec 02 2017 *)"
    ],
    "program": [
        "(PARI) a(n)=if(n<2,0,n-1+a(n\\2)+a((n+1)\\2))",
        "(PARI) a(n)=local(m);if(n<2,0,m=length(binary(n-1));n*m-2^m+1)",
        "(Haskell)",
        "import Data.List (transpose)",
        "a001855 n = a001855_list !! n",
        "a001855_list = 0 : zipWith (+) [1..] (zipWith (+) hs $ tail hs) where",
        "   hs = concat $ transpose [a001855_list, a001855_list]",
        "-- _Reinhard Zumkeller_, Jun 03 2013",
        "(Python)",
        "def A001855(n):",
        "    s, i, z = 0, n-1, 1",
        "    while 0 <= i: s += i; i -= z; z += z",
        "    return s",
        "print([A001855(n) for n in range(1, 59)]) # _Peter Luschny_, Nov 30 2017"
    ],
    "xref": [
        "Partial sums of A029837.",
        "Cf. A003071, A000337, A030190, A030308, A061168, A123753."
    ],
    "keyword": "nonn,easy,nice",
    "offset": "1,3",
    "author": "_N. J. A. Sloane_",
    "ext": [
        "Additional comments from M. D. McIlroy (mcilroy(AT)dartmouth.edu)"
    ],
    "references": 18,
    "revision": 93,
    "time": "2017-12-02T10:03:46-05:00",
    "created": "1991-04-30T03:00:00-04:00"
}