{
    "number": 109714,
    "data": "1,1,3,18,120,1170,12600,176400,2608200,46607400,883159200,19429502400,447567120000,11629447830000,316028116404000,9516436753824000,297478346845680000,10151626256147376000,359237701318479984000,13733349319337487840000,542212802070902202240000",
    "name": "Number of binary trees with root labeled by an n-set S, its n leaves by the singleton subsets of S, and other nodes labeled by subsets T of S so that the two daughter nodes of the node labeled by T are labeled by the two parts of a 2-partition of T.",
    "comment": [
        "Previous name: Number of different ways an n-ary probability distribution can be decomposed in terms of products of binary probability distributions.",
        "This sequence may have relevance to machine-learning where an n-ary probability distribution is sometimes assembled out of multiple binary distributions. These decompositions may be depicted as binary trees (with every node having zero or 2 children) and with n leaves. Every bifurcation in the tree corresponds to a binary probability distribution. The sequence defined here grows faster than the sequence of Catalan numbers A000108.",
        "Our binary trees have 2n-1 nodes. For n up to 1000, a(n) is divisible by the largest odd divisor of n!. Is this true for all n? - _Christopher J. Smyth_, Dec 03 2017"
    ],
    "link": [
        "Michael De Vlieger, <a href=\"/A109714/b109714.txt\">Table of n, a(n) for n = 1..403</a>"
    ],
    "formula": [
        "a(1) = 1, a(2) = 1 and a(n) = Sum_{i=1..floor(n/2)} binomial(n, i) * a(i) * a(n-i) for n >= 3.",
        "This recurrence follows immediately from the fact that there are binomial(n, i) 2-partitions of the n-set labeling the root having parts of sizes i and n-i. Choosing such parts to label the daughters of the root, there are then a(i)*a(n-i) ways to complete the whole tree, on regarding these daughters as new roots. - _Christopher J. Smyth_, Dec 03 2017"
    ],
    "example": [
        "For n=3, let a,b,c be three mutually exclusive events so that the probabilities of these three events sum to one: P(a)+P(b)+P(c) = 1. This is a 3-ary probability distribution. There are three ways to decompose this distribution in terms of binary distributions:",
        "1. P(a) = P(~(b||c)), P(b) = P(b||c) * P(b | (b||c) ), P(c) = P(b||c) * P(c | (b||c) )",
        "2. P(b) = P(~(a||c)), P(a) = P(a||c) * P(a | (a||c) ), P(c) = P(a||c) * P(c | (a||c) )",
        "3. P(c) = P(~(a||b)), P(a) = P(a||b) * P(a | (a||b) ), P(b) = P(a||b) * P(b | (a||b) )",
        "Here ~ denotes NOT, || denotes OR, | denotes 'given'. The probability distribution P(a||b), P(~(a||b)) is a binary distribution and so is P(a| (a||b)), P(b | (a||b)) and so on.",
        "For n = 3 and the set S={a,b,c} labeling the root, there are 3 possible choices of labels for its daughter nodes, namely {a} and {b,c}, {b} and {c,a} or {c} and {a,b}. Such a choice determines the whole tree, so a(3)=3. - _Christopher J. Smyth_, Dec 03 2017"
    ],
    "mathematica": [
        "Fold[Append[#1, Sum[Binomial[#2, i] #1[[i]] #1[[#2 - i]], {i, Floor[#2/2]}]] &, {1, 1}, Range[3, 21]] (* _Michael De Vlieger_, Dec 13 2017 *)"
    ],
    "program": [
        "(MATLAB) function m = a(n); if n==1 m = 1; elseif n==2 m = 1; else m = 0; for i=1:floor(n/2); f1 = binomial(n,i); f2 = a(i); f3 = a(n-i); m = m + f1*f2*f3; end; end;"
    ],
    "xref": [
        "Cf. A000108."
    ],
    "keyword": "easy,nonn",
    "offset": "1,3",
    "author": "Niko Brummer (niko.brummer(AT)gmail.com), Aug 08 2005",
    "ext": [
        "New name and a(12)-a(21) from _Christopher J. Smyth_, Dec 03 2017"
    ],
    "references": 1,
    "revision": 24,
    "time": "2017-12-23T04:56:41-05:00",
    "created": "2005-09-21T03:00:00-04:00"
}