{
    "number": 2995,
    "id": "M0805",
    "data": "1,1,1,1,2,3,6,14,34,95,280,854,2694,8714,28640,95640,323396,1105335,3813798,13269146,46509358,164107650,582538732,2079165208,7457847082,26873059986,97239032056,353218528324,1287658723550,4709785569184",
    "name": "Number of unlabeled planar trees (also called plane trees) with n nodes.",
    "comment": [
        "Noncrossing handshakes of 2(n-1) people (each using only one hand) on round table, up to rotations - _Antti Karttunen_, Sep 03 2000",
        "a(n), n>2, is also the number of oriented cacti on n-1 unlabeled nodes with all cutpoints of separation degree 2, i.e. ones shared only by two (cyclic) blocks. These are digraphs (without loops) that have a unique Eulerian tour. Such digraphs with labeled nodes are enumerated by A102693. - _Valery A. Liskovets_, Oct 19 2005",
        "Labeled plane trees are counted by A006963. - _David Callan_, Aug 19 2014",
        "This sequence is similar to A000055 but those trees are not embedded in a plane. - _Michael Somos_, Aug 19 2014"
    ],
    "reference": [
        "F. Bergeron, G. Labelle and P. Leroux, Combinatorial Species and Tree-Like Structures, Cambridge, 1998, pp. 285 (4.1.26), 291 (4.1.48)",
        "A. Errera, De quelques probl\u00e8mes d'analysis situs, Comptes Rend. Congr. Nat. Sci. Bruxelles, (1930), 106-110.",
        "F. Harary and E. M. Palmer, Graphical Enumeration, Academic Press, NY, 1973, p. 67, (3.3.26).",
        "N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence)."
    ],
    "link": [
        "T. D. Noe, <a href=\"/A002995/b002995.txt\">Table of n, a(n) for n=0..200</a>",
        "Paul Drube and Puttipong Pongtanapaisan, <a href=\"https://cs.uwaterloo.ca/journals/JIS/VOL19/Drube/drube3.html\">Annular Non-Crossing Matchings</a>, Journal of Integer Sequences, Vol. 19 (2016), #16.2.4.",
        "A. Errera, <a href=\"/A002995/a002995.pdf\">Reviews of two articles on Analysis Situs</a>, from Fortschritte [Annotated scanned copy]",
        "D. Feldman, <a href=\"/A002995/a002995_2.pdf\">Counting plane trees</a>, Unpublished manuscript, 1992. (Annotated scanned copy)",
        "F. Harary and R. W. Robinson, <a href=\"http://dx.doi.org/10.1515/crll.1975.278-279.322\">The number of achiral trees</a>, J. Reine Angew. Math., 278 (1975), 322-335.",
        "F. Harary and R. W. Robinson, <a href=\"/A002995/a002995_1.pdf\">The number of achiral trees</a>, J. Reine Angew. Math., 278 (1975), 322-335. (Annotated scanned copy)",
        "G. Labelle, <a href=\"http://dx.doi.org/10.1016/0304-3975(93)90300-I\">Sur la sym\u00e9trie et l'asym\u00e9trie des structures combinatoires</a>, Theor. Comput. Sci. 117, No. 1-2, 3-22 (1993).",
        "P. Leroux and B. Miloudi, <a href=\"/A000081/a000081_2.pdf\">G\u00e9n\u00e9ralisations de la formule d'Otter</a>, Ann. Sci. Math. Qu\u00e9bec, Vol. 16, No. 1, pp. 53-80, 1992. (Annotated scanned copy)",
        "T. M\u00fctze, <a href=\"http://arxiv.org/abs/1404.4442\">Proof of the middle levels conjecture</a>, arXiv preprint arXiv:1404.4442 [math.CO], 2014.",
        "Torsten M\u00fctze and Franziska Weber, <a href=\"http://arxiv.org/abs/1111.2413\">Construction of 2-factors in the middle layer of the discrete cube</a>, arXiv preprint arXiv:1111.2413 [math.CO], 2011.",
        "T. M\u00fctze and F. Weber, <a href=\"http://dx.doi.org/10.1016/j.jcta.2012.06.005\">Construction of 2-factors in the middle layer of the discrete cube</a>, Journal of Combinatorial Theory, Series A, 119(8) (2012), 1832-1855.",
        "J. Sawada, <a href=\"http://dx.doi.org/10.1145/1125994.1125995\">Generating rooted and free plane trees</a>, ACM Transactions on Algorithms, Vol. 2 No. 1 (2006), 1-13.",
        "Seunghyun Seo and Heesung Shin, <a href=\"http://igm.univ-mlv.fr/~fpsac/FPSAC02/ARTICLES/Seo.pdf\">Two involutions on vertices of ordered trees</a>, FPSAC'02 (2002). (see p_n).",
        "D. W. Walkup, <a href=\"http://dx.doi.org/10.1112/S0025579300005659\">The number of plane trees</a>, Mathematika, vol. 19, No. 2 (1972), 200-204.",
        "<a href=\"/index/Tra#trees\">Index entries for sequences related to trees</a>"
    ],
    "formula": [
        "G.f.: 1+B(x)+(C(x^2)-C(x)^2)/2 where B is g.f. of A003239 and C is g.f. of A000108(n-1).",
        "a(n) = 1/(2*(n-1))*sum{d|(n-1)}(phi((n-1)/d)*binomial(2d, d)) - A000108(n-1)/2 + (if n is even) A000108(n/2-1)/2."
    ],
    "example": [
        "G.f. = 1 + x + x^2 + x^3 + 2*x^4 + 3*x^5 + 6*x^6 + 14*x^7 + 34*x^8 + 95*x^9 + ...",
        "a(7) = 14 = 11 + 3 because there are 11 trees with 7 nodes but three of them can be embedded in a plane in two ways. These three trees have degree sequences 4221111, 3321111, 3222111, where there are two trees with each degree sequence but in the first, the two nodes of degree two are adjacent, in the second, the two nodes of degree three are adjacent, and in the third, the node of degree three is adjacent to two nodes of degree two. - _Michael Somos_, Aug 19 2014"
    ],
    "maple": [
        "with (powseries): with (combstruct): n := 27: Order := n+2: sys := {C = Cycle(B), B = Union(Z,Prod(B,B))}: G003239 := (convert(gfseries(sys,unlabeled,x) [C(x)], polynom)) / x: G000108 := convert(taylor((1-sqrt(1-4*x)) / (2*x),x),polynom): G002995 := 1 + G003239 + (eval(G000108,x=x^2) - G000108^2)/2: A002995 := 1,1,1,seq(coeff(G002995,x^i),i=1..n); # Ulrich Schimke, Apr 05 2002",
        "with(combinat): with(numtheory): m := 2: for p from 2 to 28 do s1 := 0: s2 := 0: for d from 1 to p do if p mod d = 0 then s1 := s1+phi(p/d)*binomial(m*d, d) fi: od: for d from 1 to p-1 do if gcd(m, p-1) mod d = 0 then s2 := s2+phi(d)*binomial((p*m)/d, (p-1)/d) fi: od: printf(`%d, `, (s1+s2)/(m*p)-binomial(m*p, p)/(p*(m-1)+1)) od : # _Zerinvary Lajos_, Dec 01 2006"
    ],
    "mathematica": [
        "a[0] = a[1] = 1; a[n_] := (1/(2*(n-1)))*Sum[ EulerPhi[(n-1)/d]*Binomial[2*d, d], {d, Divisors[n-1]}] - CatalanNumber[n-1]/2 + If[ EvenQ[n], CatalanNumber[n/2-1]/2, 0]; Table[ a[n], {n, 0, 29}] (* _Jean-Fran\u00e7ois Alcover_, Mar 07 2012, from formula *)"
    ],
    "program": [
        "(PARI) catalan(n) = binomial(2*n, n)/(n+1);",
        "a(n) = if (n<2, 1, n--; sumdiv(n, d, eulerphi(n/d)*binomial(2*d, d))/(2*n) - catalan(n)/2 + if ((n-1) % 2, 0, catalan((n-1)/2)/2)); \\\\ _Michel Marcus_, Jan 23 2016"
    ],
    "xref": [
        "Cf. A000055, A000108, A002996, A003239, A005354, A057502, A061417, A064640."
    ],
    "keyword": "nonn,easy,nice",
    "offset": "0,5",
    "author": "_N. J. A. Sloane_",
    "ext": [
        "More terms, formula from _Christian G. Bower_, Dec 15 1999",
        "Name corrected (\"labeled\" --> \"unlabeled\") by _David Callan_, Aug 19 2014"
    ],
    "references": 26,
    "revision": 87,
    "time": "2017-11-08T22:10:48-05:00",
    "created": "1991-04-30T03:00:00-04:00"
}