{
    "number": 131407,
    "data": "1,2,11,95,1307,27035,788279,30812087,1554832679,98387784047,7628836816295,711320467520855,78520062277781087,10127079289703949695,1508987827451079129599,257250406707409951420079,49750955749787132205813743,10833471589449269308161546191",
    "name": "Repeated set partitions or nested set partitions. Possible coalitions among n persons.",
    "comment": [
        "Consider a set N={1,2,3,...n}. We can apply the operation S~(N) on N which gives us the set partitions S~(N)=SP(N) of N. Let denote SP_i(N) such a set partition, then SP(N)={SP_1(N), SP_2(N)...,SP_B(n)} (There are B(n) set partitions of N with B(n) as the Bell number). Observe that in each SP(N) we have SP(1)={{1,2,3,...,n}} and SP(B(n))={{1},{2},{3},...,{n}} and their magnitudes are |SP(1)|=1 and |SP(B(n)|=n.",
        "Now we perform an iteration on the set partitions SP_i(N). We set partition each SP_i(N), thus we perform S~(SP_i(N), but we exclude SP(1)={{1,2,3,...,n}} and SP(B(n))={{1},{2},{3},...,{n}} from this repetition. Otherwise an infinite recursion arises. Thus if 1 < |SP_i(N)|=m < n, then we apply S~ on SP_i(N) again and get S~(SP_i(N))= SP(SP_i(N))={SP_1(SP_i(N)),...,SP_B(m)(SP_i(N))}. We repeat this partition operation S~ on every set partition we encounter. Let denote U_k a subset of SP_i(X) were X is a set. X may be any of the subsequent set partitions. Since |U_k| < X (under the condition above on m) the repeated application of S~ will end in set partitions SP(X) with |SP(X)| = 1.",
        "Let us consider the example N={1,2,3}. The S~(N) gives us {{1,2,3}}, {{1,2},{3}}, {{1,3},{2}}, {{2,3},{13}} and {{1},{2},{1}}. We exclude {{1,2,3}} and {{1},{2},{1}} from further partitioning. From {{1,2},{3}} we get {{{1,2},{3}}} and {{{1,2}},{{3}}}. Consider the last two partitions. They correspond to N'={1',2'} and are thus {{1',2'}} and {{1'},{2'}}. Since |{{1',2'}}|=1 and |{{1'},{2'}}|=2 these last two set partitions cannot be partitioned any further according to our condition above. In total we get {{1,2,3}}, {{1,2},{3}}, {{1,3},{2}}, {{2,3},{1}}, {{{1,2},{3}}}, {{{1,2}},{{3}}}, {{{1,3},{2}}}, {{{1,3}},{{2}}}, {{{2,3},{1}}}, {{{2,3}},{{1}}}, {{1},{2},{3}} and we have a(n=3)=11.",
        "A possible application are the number of coalitions among the set N={1,2,...,n} of n persons. These persons will split into parties = subsets U_k of N. Then coalitions will form among these parties, thus we encounter sets of subsets. It is even possible that coalitions form coalitions in turn. We thus define a coalition structure as a set of repeated set partitions. For example if n=6 we could have {{1,2},{3}},{{4,5,6}}, the parties {1,2} and {3} form the coalition {{1,2},{3}}. Since {{456}}={4,5,6} one might not want to consider a single set as a coalition, but formally it is possible to do so. However, if in the example all three parties are patriotic, they may stand together in questions of national interest and the coalition structure would be {{{1,2},{3}},{{4,5,6}}}.",
        "However, in my opinion, the usual definition of a coalition as a partition of a set falls too short.",
        "See also A005121 = Ultradissimilarity relations on an n-set. The paper \"On the Asymptotic Analysis of a Class of Linear Recurrences\" (by Thomas Prellberg) outlines how to find an asymptotic formula for A005121. Perhaps this method is applicable to the present sequence as well, but one needs to have the generating function as starting point."
    ],
    "reference": [
        "S. R. Finch, Mathematical Constants, Cambridge, 2003, p. 319 and 556."
    ],
    "link": [
        "Alois P. Heinz, <a href=\"/A131407/b131407.txt\">Table of n, a(n) for n = 1..100</a>",
        "Thomas Prellberg, <a href=\"http://algo.inria.fr/seminars/summary/Prellberg2002a.pdf\">On the Asymptotic Analysis of a Class of Linear Recurrences</a>, Algorithms Seminar 2002-2004, F. Chyzak (ed.), INRIA, (2005), pp. 47-50.",
        "Thomas Wieder, <a href=\"/A131407/a131407.txt\">VB Program</a>"
    ],
    "formula": [
        "Recurrence: a(1)=1, a(2)=2, a(n) = Bell(n) + sum_{i=2}^{n-1} S2(n,i) a(i) E.g.: a(n=4) = Bell(4) + S2(4,2) a(2) + S2(4,3) a(3) = 15+2+7*2+6*11 = 95. \"closed\" formula: a(n=4) = Bell(n=4) + sum_{i1=2}^{(n=4)-1} Bell(i1)+S2(n,i1)*sum_{i2=2}^{i1-1} Bell(i2)+S2(i1,i2)*sum_{i3=2}^{i2-1} Bell(i3)+S2(i2,i3)*sum_{i4=2}^{i3-1} Stirling2(i3,i4).",
        "a(n) ~ 3 * L * (n!)^2 / (n^(1+log(2)/3) * (2*log(2))^n), where L = Lengyel's constant A086053 = 1.0986858055... . - _Vaclav Kotesovec_, Sep 04 2014"
    ],
    "example": [
        "a(n=3)=11 because we have {{1,2,3}}, {{1,2},{3}}, {{1,3},{2}}, {{2,3},{1}}, {{{1,2},{3}}}, {{{1,2}},{{3}}}, {{{1,3},{2}}}, {{{1,3}},{{2}}}, {{{2,3},{1}}}, {{{2,3}},{{1}}}, {{1},{2},{3}}."
    ],
    "maple": [
        "rctlnn := proc(n::nonnegint) # Thanks to Joe Riel who suggested to use # \"procname\" instead of \"rctlnn\" within the program.",
        "local j; option remember; if n = 0 then 0; else bell(n)+add(stirling2(n,j)*procname(j), j=2..n-1); end if; end proc:",
        "# second Maple program",
        "with(combinat):",
        "a:= proc(n) option remember;",
        "      `if`(n<2, 1, bell(n) +add(stirling2(n, i)*a(i), i=2..n-1))",
        "    end:",
        "seq(a(n), n=1..20); # _Alois P. Heinz_, Apr 05 2012"
    ],
    "mathematica": [
        "a[n_] := a[n] = If[n<2, 1, BellB[n] + Sum[StirlingS2[n, i]*a[i], {i, 2, n-1}]]; Table[a[n], {n, 1, 20}] (* _Jean-Fran\u00e7ois Alcover_, Jul 15 2015, after _Alois P. Heinz_ *)"
    ],
    "program": [
        "(VB) See Wieder link."
    ],
    "xref": [
        "Cf. A000110, A131408, A086053."
    ],
    "keyword": "nonn",
    "offset": "1,2",
    "author": "_Thomas Wieder_, Jul 09 2007, Jul 20 2007",
    "references": 6,
    "revision": 32,
    "time": "2016-11-20T07:26:01-05:00",
    "created": "2007-11-10T03:00:00-05:00"
}