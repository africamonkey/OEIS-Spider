{
    "number": 2076,
    "id": "M0761 N0288",
    "data": "1,2,3,6,9,26,53,146,369,1002,2685,7434,20441,57046,159451,448686,1266081,3588002,10195277,29058526,83018783,237740670,682196949,1961331314,5648590737,16294052602,47071590147,136171497650,394427456121,1143839943618,3320824711205",
    "name": "Number of equivalence classes of base-3 necklaces of length n, where necklaces are considered equivalent under both rotations as well as permutations of the symbols.",
    "reference": [
        "N. J. Fine, Classes of periodic sequences, Illinois J. Math., 2 (1958), 285-302.",
        "N. J. A. Sloane, A Handbook of Integer Sequences, Academic Press, 1973 (includes this sequence).",
        "N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence)."
    ],
    "link": [
        "Vincenzo Librandi, <a href=\"/A002076/b002076.txt\">Table of n, a(n) for n = 1..500</a>",
        "E. N. Gilbert and J. Riordan, <a href=\"http://projecteuclid.org/euclid.ijm/1255631587\">Symmetry types of periodic sequences</a>, Illinois J. Math., 5 (1961), 657-665.",
        "N. J. A. Sloane, <a href=\"/A000013/a000013.txt\">Maple code for this and related sequences</a>",
        "<a href=\"/index/Ne#necklaces\">Index entries for sequences related to necklaces</a>"
    ],
    "formula": [
        "Reference gives formula."
    ],
    "example": [
        "E.g., a(2) = 2 as there are two equivalence classes of the 9 strings {00,01,02,10,11,12,20,21,22}: {00,11,22} form one equivalence class and {01,02,10,12,20,21} form the other. To see that (for example) 01 and 02 are equivalent, rotate 01 to 10 and then subtract 1 mod 3 from each element in 10 to get 02."
    ],
    "mathematica": [
        "Adn[d_, n_] := Module[{ c, t1, t2}, t2 = 0; For[c = 1, c <= d, c++, If[Mod[d, c] == 0 , t2 = t2 + (x^c/c)*(E^(c*z) - 1)]]; t1 = E^t2; t1 = Series[t1, {z, 0, n+1}]; Coefficient[t1, z, n]*n!]; Pn[n_] := Module[{ d, e, t1}, t1 = 0; For[d = 1, d <= n, d++, If[Mod[n, d] == 0, t1 = t1 + EulerPhi[d]*Adn[d, n/d]/n]]; t1/(1 - x)]; Pnq[n_, q_] := Module[{t1}, t1 = Series[Pn[n], {x, 0, q+1}] ; Coefficient[t1, x, q]]; a[n_] := Pnq[n, 3]; Table[Print[an = a[n]]; an, {n, 1, 28}] (* _Jean-Fran\u00e7ois Alcover_, Oct 04 2013, after _N. J. A. Sloane_'s Maple code *)",
        "(* This Mathematica program uses Gilbert and Riordan's recurrence formula, which they recommend for calculations: *)",
        "Adn[d_, n_] :=  Adn[d, n] = Which[0==n, 1, 1==n, DivisorSum[d, x^# &],",
        "  1 == d, Sum[StirlingS2[n, k] x^k, {k, 0, n}], True,",
        "  Expand[Adn[d, 1] Adn[d, n - 1] + D[Adn[d, n - 1], x] x]];",
        "Table[SeriesCoefficient[DivisorSum[n, EulerPhi[#] Adn[#, n/#] &]",
        "/(n (1 - x)), {x, 0, 3}], {n, 1, 40}]  (* _Robert A. Russell_, Feb 24 2018 *)"
    ],
    "xref": [
        "Cf. A000013, A000048, A002075."
    ],
    "keyword": "nonn,easy,nice,changed",
    "offset": "1,2",
    "author": "_N. J. A. Sloane_",
    "ext": [
        "Better description and more terms from Mark Weston (mweston(AT)uvic.ca), Oct 06 2001"
    ],
    "references": 7,
    "revision": 27,
    "time": "2018-02-28T17:58:46-05:00",
    "created": "1991-04-30T03:00:00-04:00"
}